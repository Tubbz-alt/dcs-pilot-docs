---
title: Message structure
weight: 4
---

# Message structure


## Cryptography

Mutual-auth [Transport Layer Security (TLS) Protocol Version 1.2][TLS] secures the messages your client exchanges with the Document Checking Service (DCS).

Our Certificate Authority provides certificates for the public key infrastructure (PKI). Details about how to raise a certificate signing request with our Certificate Authority will follow after the Expression of Interest phase.

Messages your client exchanges with DCS must use the following IETF standards:

 - [Javascript Object Signing and Encryption (JOSE)][JOSE]
 - [JSON Web Signature (JWS)][JWS]
 - [JSON Web Encryption (JWE)][JWE]

### Signing

Requests must be signed using RSASSA-PKCS1-V1_5 with RS256s, which corresponds to using SHA256 in the JWE “alg” header.

### Encryption

Requests must be encrypted using RSAES OAEP with A128CBC-HS256 (which uses a SHA256 HMAC), corresponding to the JWE “enc” header.


## Building a request

API calls to check the validity of a document are synchronous POST requests over HTTPS.

The HTTP header must contain `Content-Type: application/jose`.

The API messages contained in the JWS and JWE wrappers are JSON objects. To build the JOSE wrapper, your JSON object is first signed, then encrypted, and then signed again.

<%= image_tag "dcs-message-structure.svg" %>

The signatures and encryption use the [JSON Web Signature (JWS)][JWS] and [JSON Web Encryption JWE][JWE] compact serialisations.

All JWS Headers must include the `x5t` header parameter. This is to allow DCS to identify the correct certificate to use to check that the message was sent by a specific entity.

All requests and responses must include:

* a correlation ID, which is the same for a particular session
* a request ID, which is unique to that request

For example, if you check the same user's document several times in the same session, all requests to DCS will have the same correlation ID. Each request will have a unique request ID.

<%= partial "partials/links" %>
