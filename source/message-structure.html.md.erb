---
title: Message structure
weight: 4
---

# Message structure


## Cryptography

Messages your client exchanges with the Document Checking Service (DCS) must use the following Internet Engineering Task Force
(IETF) standards:

 - [JavaScript Object Notation (JSON)][JSON]
 - [JavaScript Object Signing and Encryption (JOSE)][JOSE]
 - [JSON Web Signature (JWS)][JWS]
 - [JSON Web Encryption (JWE)][JWE]

Our Certificate Authority will issue certificates for the [public key infrastructure (PKI)][RFC 6712]. Details about how to raise a certificate signing request with our Certificate Authority will follow after the expression of interest phase of the DCS pilot.

### Signing

Signing provides the receiver with assurance of who authored the message. The signature also guarantees that the message hasnâ€™t been tampered with since the author signed it.

Your client signs requests with your private signing key. When receiving the request, the DCS uses your signing certificate to verify that you sent the request.

Responses from the DCS are signed with the DCS's private signing key. Your client uses the DCS's signing certificate to verify that the response came from the DCS.

#### Signing keys and certificates

You must generate a private signing key and raise a certificate signing request to our Certificate Authority. Details about how to raise a certificate signing request with our Certificate Authority will follow after the expression of interest phase of the DCS pilot.

You will receive the DCS's signing certificate.

#### Signing algorithms

Requests to the DCS must be signed using [RSASSA-PKCS1-V1_5] with RS256s, which corresponds to using SHA256 in the [JWE] `alg` header.

### Encryption

Encryption provides the sender with assurance that only the intended receiver can see the message.

Your client encrypts requests using the DCS's encryption certificate. When receiving the request, the DCS uses its private encryption key to decrypt your request.

Responses from the DCS are encrypted with your encryption certificate. Your client then uses your private encryption key to decrypt the response form DCS.

#### Encryption keys and certificates

You must generate a private encryption key and raise a certificate signing request with our Certificate Authority. Details about how to raise a certificate signing request with our Certificate Authority will follow after the expression of interest phase of the DCS pilot.

You will receive the DCS's signing certificate.

#### Encryption algorithms

Requests must be encrypted using [RSAES-OAEP] with A128CBC-HS256 (which uses a SHA256 HMAC), corresponding to the [JWE] `enc` header.

## Signature and encryption wrapper

The JSON object in request and response bodies is protected by a signature and encryption wrapper.

To build the [signature (JWS)][JWS] and [encryption (JWE)][JWE] wrapper for your JSON object, you must:

1. Sign your JSON object with your signing key using JWS.
2. Encrypt your signed JSON object with your encryption key using JWE.
3. Sign the encrypted content with your signing key using JWS.

<%= image_tag "dcs-message-structure.svg" %>

All JWS Headers must include the `x5t` header parameter. This is to allow the DCS to identify the correct certificate to use to check that the message was sent by a specific entity.

<%= partial "partials/links" %>
